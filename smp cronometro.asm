#include "p16f877a.inc"


 __CONFIG _FOSC_HS & _WDTE_OFF & _PWRTE_OFF & _BOREN_OFF & _LVP_OFF & _CPD_OFF & _WRT_OFF & _CP_OFF

 GPR_VAR        UDATA
    FT1MS		RES        1
    		
    FT1MS_1S		RES        1
    FT250MS_1S		RES        1	
    FT1S_1S		RES        1
    
    CUR_DEZ		RES	   1
    CUR_UNI		RES	   1
    
    COUNTER		RES	    1
   
  
BANK0 MACRO
   BCF STATUS, RP1 
   BCF STATUS, RP0
   ENDM

BANK1 MACRO
   BCF STATUS, RP1 
   BSF STATUS, RP0
   ENDM

BANK2 MACRO
   BSF STATUS, RP1 
   BCF STATUS, RP0
   ENDM

BANK3 MACRO
   BSF STATUS, RP1 
   BSF STATUS, RP0
   ENDM
 
 
RES_VECT  CODE    0x0000            
    GOTO    START                   


MAIN_PROG CODE                      

    DELAY_1MS
	MOVLW D'165'       
	MOVWF FT1MS
    
	DELAY_LOOP_1MS
	    DECFSZ FT1MS, 1    
	    GOTO  DELAY_LOOP_1MS
    RETURN
    
 
    DELAY_1S
	MOVLW D'165'        
	MOVWF FT1MS_1S
	MOVLW D'250'        
	MOVWF FT250MS_1S
	MOVLW D'4'        
	MOVWF FT1S_1S

    DELAY_LOOP
	DECFSZ FT1MS_1S, 1    
	GOTO  DELAY_LOOP 
  
	MOVLW D'165'      
	MOVWF FT1MS_1S
	DECFSZ FT250MS_1S, 1  
	GOTO  DELAY_LOOP 
    
	MOVLW D'250'        
	MOVWF FT250MS_1S
	DECFSZ FT1S_1S, 1    
	GOTO  DELAY_LOOP 
	
    RETURN
    
    SET_DISPLAY
	MOVLW D'250'
	MOVWF COUNTER

   COUNT
	DECFSZ COUNTER,1
	GOTO EXE
	RETURN
	
	EXE
	;UNI
	MOVLW B'00010000' 
	MOVWF PORTA
	
	MOVFW CUR_DEZ
	MOVWF PORTD
	CALL DELAY_1MS
	CALL DELAY_1MS

	;DEZ
	MOVLW B'00100000'
	MOVWF PORTA
	
	MOVFW CUR_UNI
	MOVWF PORTD
	CALL DELAY_1MS
	CALL DELAY_1MS
	
	GOTO COUNT
	
	
  
    SET_DEZENA
    
	MOVLW B'01100111'
	MOVWF CUR_UNI
	CALL SET_DISPLAY
 ;8
	
	MOVLW B'01111111'
	MOVWF CUR_UNI
	CALL SET_DISPLAY
 ;7
	
	MOVLW B'00000111'
	MOVWF CUR_UNI
	CALL SET_DISPLAY
 ;6
	
	MOVLW B'01111100'
	MOVWF CUR_UNI
	CALL SET_DISPLAY
 ;5
	
	MOVLW B'01101101'
	MOVWF CUR_UNI
	CALL SET_DISPLAY
 ;4
	
	MOVLW B'01100110'
	MOVWF CUR_UNI
	CALL SET_DISPLAY
 ;3
	
	MOVLW B'01001111'
	MOVWF CUR_UNI
	CALL SET_DISPLAY
 ;2
	
	MOVLW B'01011011'
	MOVWF CUR_UNI
	CALL SET_DISPLAY
 ;1
	
	MOVLW B'00000110'
	MOVWF CUR_UNI
	CALL SET_DISPLAY
 ;0
	
	MOVLW B'00111111'
	MOVWF CUR_UNI
	CALL SET_DISPLAY
    
    RETURN
 
   

   
   
  
START
    
   BANK1
   CLRF TRISD
   CLRF TRISB
   CLRF TRISA
   BANK0
   

  CRONOMETRO
    MOVLW B'01101101'
    MOVWF CUR_DEZ
    CALL SET_DEZENA
    
    MOVLW B'01100110'
    MOVWF CUR_DEZ
    CALL SET_DEZENA
    
    MOVLW B'01001111'
    MOVWF CUR_DEZ
    CALL SET_DEZENA
    
    MOVLW B'01011011'
    MOVWF CUR_DEZ
    CALL SET_DEZENA
    
    MOVLW B'00000110'
    MOVWF CUR_DEZ
    CALL SET_DEZENA
    
    MOVLW B'00111111'
    MOVWF CUR_DEZ
    CALL SET_DEZENA
  GOTO CRONOMETRO
   
   END